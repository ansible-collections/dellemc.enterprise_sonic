---
- name: Delete existing MCLAG configuration
  sonic_mclag:
    config:
    state: deleted
  failed_when: false

- name: Deletes old VXLANs configuration
  sonic_vxlans:
    config: []
    state: deleted
  failed_when: false

- name: Intialize route maps
  vars:
    ansible_connection: network_cli
  sonic_config:
    commands: "{{ preparations_tests.init_route_map }}"
  failed_when: false

- name: Initialize prefix lists
  vars:
    ansible_connection: network_cli
  sonic_config:
    commands: "{{ preparations_tests.init_prefix_list }}"
  failed_when: false

- name: Initialize VRFs
  vars:
    ansible_connection: network_cli
  sonic_config:
    commands: "{{ preparations_tests.init_vrf }}"
  failed_when: false

- name: Deletes old BGP configuration
  sonic_bgp:
    config: []
    state: deleted
  failed_when: false

- name: Create BGP
  sonic_bgp:
    config: "{{ preparations_tests.init_bgp }}"
    state: merged
  failed_when: false

- name: Create BGP neighbors
  sonic_bgp_neighbors:
    config: "{{ preparations_tests.init_bgp_neighbors }}"
    state: merged
  failed_when: false
