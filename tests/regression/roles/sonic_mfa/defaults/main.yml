---
ansible_connection: httpapi
module_name: mfa

tests:
  - name: test_case_01
    description: Add MFA global and RSA global configurations
    state: merged
    input:
      mfa_global:
        client_secret: 'U2FsdGVkX19xLfE9fv08fh8ldxBlnJlTF2H75FeGamOPfGgwlKsykMMqcFf7/k5wrWt3jC5mewgDDJKwRwXRekSQWZu3rfeHdjWKWpi8C8OUAP76LSRco+mth2AROI32'
        client_secret_encrypted: true
        key_seed: 'U2FsdGVkX1/BI2rAgO+0uKHHFhuTkTOkVU81xetpL1s='
        key_seed_encrypted: true
        security_profile: 'mSecurityProfile'
      rsa_global:
        security_profile: 'rSecurityProfile'

  - name: test_case_02
    description: Add CAC-PIV global and RSA server configurations
    state: merged
    input:
      cac_piv_global:
        cert_username_field: 'user-principal-name'
        cert_username_match: 'username-without-domain'
        security_profile: 'cSecurityProfile'
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'
          client_id: 'sonicdevtest.che-lab.it'
          client_key: 'U2FsdGVkX1+94j0HxRUXYmrV3egRH3IfK5RL/6c3+j4zJifd9DTYIbPuyf7It+/ytbneKaQGJSngvFkOk35G1pUdaP3LOJRslReFDzK5KgyEpOI3bAy0Z3nm8n/W809L'
          client_key_encrypted: true
          connection_timeout: 29
          read_timeout: 149
          server_port: 1030

  - name: test_case_03
    description: Modify MFA configs
    state: merged
    input:
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'
          connection_timeout: 28
      cac_piv_global:
        cert_username_field: 'common-name'
        cert_username_match: '10digit-username'

  - name: test_case_04
    description: Delete specific MFA configs
    state: deleted
    input:
      mfa_global:
        security_profile: 'mSecurityProfile'
      rsa_global:
        security_profile: 'rSecurityProfile'
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'
          server_port: 1030
          connection_timeout: 28
          read_timeout: 149
      cac_piv_global:
        cert_username_field: 'common-name'
        cert_username_match: '10digit-username'
        security_profile: 'cSecurityProfile'
 
  - name: test_case_05
    description: Delete RSA server using hostname
    state: deleted
    input:
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'

  - name: test_case_06
    description: Override MFA configurations
    state: overridden
    input:
      cac_piv_global:
        cert_username_field: 'common-name'
        cert_username_match: '10digit-username'
        security_profile: 'cSecurityProfile'
      rsa_global:
        security_profile: 'rSecurityProfile'

  - name: test_case_07
    description: Add MFA configurations for replace
    state: merged
    input:
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'
          client_id: 'sonicdevtest.che-lab.it'
          client_key: 'U2FsdGVkX1+94j0HxRUXYmrV3egRH3IfK5RL/6c3+j4zJifd9DTYIbPuyf7It+/ytbneKaQGJSngvFkOk35G1pUdaP3LOJRslReFDzK5KgyEpOI3bAy0Z3nm8n/W809L'
          client_key_encrypted: true
          connection_timeout: 29
          read_timeout: 149
          server_port: 1030

  - name: test_case_08
    description: Replace RSA server configurations
    state: replaced
    input:
      rsa_servers:
        - hostname: 'rsaserver.che-lab.it'
          connection_timeout: 23
          read_timeout: 143
          server_port: 1033

  - name: test_case_09
    description: Delete all MFA configurations
    state: deleted
    input: {}
