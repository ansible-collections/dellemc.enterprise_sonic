---
ansible_connection: httpapi
module_name: tacacs_pki

preparations_tests:
  delete_pki:
    - name: delete_all
      description: Delete PKI
      state: deleted
      input:
tests:
  - name: test_case_01
    description: Add new PKI configuration
    state: merged
    input:
      security-profiles:
        - profile-name: mysp
        - profile-name: myspb
          ocsp-responder-list:
            - http://localhost/ocsp
      trust-stores:
        - name: myts
          ca-name: CA2

  - name: test_case_02
    description: Update specific params of security-profile
    state: merged
    input:
      security-profiles:
        - profile-name: mysp
          cdp-list:
            - http://example.com/cdp
          trust-store: myts
          revocation-check: False
  - name: test_case_03
    description: Delete specific params of security-profile
    state: deleted
    input:
      security-profiles:
        - profile-name: mysp
          cdp-list:
            - http://example.com/cdp
  - name: test_case_04
    description: Delete all security-profiles configurations
    state: deleted
    input:
      security-profiles:
        - profile-name: mysp
        - profile-name: myspb

  - name: test_case_05
    description: Merge parameter of security-profiles configurations
    state: merged
    input:
      security-profiles:
        - profile-name: mysp
          revocation-check: False
          peer-name-check: True
        - profile-name: myspb
          ocsp-responder-list:
            - http://localhost/ocsp
          trust-store: myts
          key-usage-check: True

  - name: test_case_06
    description: Replace some parameter of security-profiles
    state: replaced
    input:
      security-profiles:
        - profile-name: mysp
          revocation-check: True

  - name: test_case_07
    description: Replace CA of trust-store
    state: replaced
    input:
      trust-stores:
        - name: myts
          ca-name: CA

  - name: test_case_08
    description: Override parameter of security-profiles
    state: overridden
    input:
      security-profiles:
        - profile-name: mysp
          revocation-check: False
          peer-name-check: True
        - profile-name: myspb
          ocsp-responder-list:
            - http://localhost/ocsp
          key-usage-check: True
      trust-stores:
        - name: myts
          ca-name: CA

test_delete_all:
  - name: test_case_09
    description: Delete all PKI configurations
    state: deleted
