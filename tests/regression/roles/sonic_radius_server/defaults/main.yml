---
ansible_connection: httpapi
module_name: radius_server

preparations_tests:
  delete_radius_server:
    - name: delete_all
      description: Configure radius server
      state: deleted
      input:
tests:
  - name: test_case_01
    description: Add new host configuration
    state: merged
    input:
      auth_type: chap
      timeout: 12
      nas_ip: 10.11.12.13
      retransmit: 5
      statistics: true
      servers:
        host:
          - name: my_host1
            auth_type: chap
            priority: 3
            vrf: mgmt
            timeout: 12
            port: 55
            source_interface: "{{ interface1 }}"
            retransmit: 7
          - name: my_host2
            auth_type: pap
            priority: 4
            vrf: mgmt
            timeout: 15
            port: 56
            source_interface: "{{ interface2 }}"
            retransmit: 8
          - name: my_host3
            auth_type: mschapv2
            priority: 6
            vrf: mgmt
            timeout: 20
            port: 57
            source_interface: "{{ interface3 }}"
            retransmit: 9
  - name: test_case_02
    description: Update specific params of radius server
    state: merged
    input:
      auth_type: mschapv2
      timeout: 24
      servers:
        host:
          - name: my_host
            auth_type: mschapv2
            port: 45
            timeout: 9
            vrf: mgmt
  - name: test_case_03
    description: Delete specific params of radius server
    state: deleted
    input:
      key: login
      timeout: 24
      servers:
        host:
          - name: my_host
  - name: test_case_04
    description: Delete all hosts configurations
    state: deleted
    input:
      servers:
        host:
  - name: test_case_05
    description: Add new host configuration
    state: merged
    input:
      auth_type: chap
      timeout: 12
      nas_ip: 10.11.12.13
      retransmit: 5
      statistics: true
      servers:
        host:
          - name: my_host1
            auth_type: chap
            priority: 3
            vrf: mgmt
            timeout: 12
            port: 55
            source_interface: "{{ interface1 }}"
            retransmit: 7
          - name: my_host2
            auth_type: pap
            priority: 4
            vrf: mgmt
            timeout: 15
            port: 56
            source_interface: "{{ interface2 }}"
            retransmit: 8
          - name: my_host3
            auth_type: mschapv2
            priority: 6
            vrf: mgmt
            timeout: 20
            port: 57
            source_interface: "{{ interface3 }}"
            retransmit: 9

  - name: test_case_06
    description: Replace some configuration of radius servers
    state: replaced
    input:
      auth_type: mschapv2
      timeout: 36
      nas_ip: 11.11.11.22
      retransmit: 5
      statistics: true
      servers:
        host:
          - name: my_host
            auth_type: chap
            port: 55
            timeout: 12
            priority: 3
            source_interface: "{{ interface3 }}"

  - name: test_case_07
    description: Replace hosts of radius servers
    state: replaced
    input:
      auth_type: mschapv2
      timeout: 36
      nas_ip: 11.11.11.22
      retransmit: 5
      statistics: true
      servers:
        host:
          - name: my_host
            auth_type: chap
            port: 55
            timeout: 21
            priority: 3
            source_interface: "{{ interface3 }}"
          - name: 20.21.22.23
            auth_type: pap
            port: 50
            timeout: 38
            priority: 4
            source_interface: "{{ interface2 }}"
          - name: 18.21.22.23
            auth_type: chap
            port: 20
            timeout: 19
            priority: 8
            source_interface: "{{ interface1 }}"

  - name: test_case_08
    description: Override configuration of radius server
    state: overridden
    input:
      auth_type: mschapv2
      timeout: 20
      nas_ip: 10.10.10.20
      retransmit: 3
      servers:
        host:
          - name: 10.11.11.11
            auth_type: pap
            port: 55
            timeout: 12
            priority: 3
            retransmit: 8
            source_interface: "{{ interface2 }}"
          - name: your_host
            auth_type: chap
            port: 50
            timeout: 30
            priority: 6
            source_interface: "{{ interface3 }}"

test_delete_all:
  - name: test_case_09
    description: Delete all the configurations of radius server
    state: deleted
