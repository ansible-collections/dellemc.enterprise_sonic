---
merged_01:
  module_args:
    config:
      authentication:
        auth_method:
          - local
          - ldap
          - radius
          - tacacs+
        console_auth_local: True
        failthrough: True
      authorization:
        commands_auth_method:
          - local
          - tacacs+
        login_auth_method:
          - local
          - ldap
  existing_aaa_config:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      response:
        code: 200
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      response:
        code: 200
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      response:
        code: 200
  expected_config_requests:
    - path: '/data/openconfig-system:system/aaa/authentication/config' 
      method: 'patch'
      data:
        openconfig-system:config:
          authentication-method:
            - local
            - ldap
            - radius
            - tacacs+
          console-authentication-local: True
          failthrough: 'True'
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'patch'
      data:
        openconfig-system:authorization:
          openconfig-aaa-tacacsplus-ext:commands:
            config:
              authorization-method:
                - local
                - tacacs+
          openconfig-aaa-ext:login:
            config:
              authorization-method:
                - local
                - ldap

replaced_01:
  module_args:
    config:
      authentication:
        console_auth_local: True
      authorization:
        commands_auth_method:
          - local
    state: replaced
  existing_aaa_config:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      response:
        code: 200
        value:
          openconfig-system:config:
            authentication-method:
              - local
              - ldap
              - radius
              - tacacs+
            console-authentication-local: True
            failthrough: 'True'
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      response:
        code: 200
        value: 
          openconfig-aaa-tacacsplus-ext:authorization-method:
            - local
            - tacacs+

    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-ext:authorization-method:
            - local
            - ldap
  expected_config_requests:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      method: 'patch'
      data:
        openconfig-system:config:
          console-authentication-local: True
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'patch'
      data:
        openconfig-system:authorization:
          openconfig-aaa-tacacsplus-ext:commands:
            config:
              authorization-method:
                - local

overridden_01:
  module_args:
    config:
      authentication:
        auth_method:
          - local
          - ldap
          - radius
          - tacacs+
        console_auth_local: True
        failthrough: True
      authorization:
        commands_auth_method:
          - local
          - tacacs+
        login_auth_method:
          - local
          - ldap
    state: overridden
  existing_aaa_config:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      response:
        code: 200
        value:
          openconfig-system:config:
            console-authentication-local: False
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-tacacsplus-ext:authorization-method:
            - local
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      response:
        code: 200
  expected_config_requests:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      method: 'patch'
      data:
        openconfig-system:config:
          authentication-method:
            - local
            - ldap
            - radius
            - tacacs+
          console-authentication-local: True
          failthrough: 'True'
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'patch'
      data:
        openconfig-system:authorization:
          openconfig-aaa-tacacsplus-ext:commands:
            config:
              authorization-method:
                - local
                - tacacs+
          openconfig-aaa-ext:login:
            config:
              authorization-method:
                - local
                - ldap

deleted_01:
  module_args:
    config:
      authentication:
        auth_method:
          - local
          - ldap
          - radius
          - tacacs+
        console_auth_local: True
        failthrough: True
      authorization:
        commands_auth_method:
          - local
          - tacacs+
        login_auth_method:
          - local
          - ldap
    state: deleted
  existing_aaa_config:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      response:
        code: 200
        value:
          openconfig-system:config:
            authentication-method:
              - local
              - ldap
              - radius
              - tacacs+
            console-authentication-local: True
            failthrough: 'True'
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-tacacsplus-ext:authorization-method:
            - local
            - tacacs+

    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-ext:authorization-method:
            - local
            - ldap
  expected_config_requests:
    - path: '/data/openconfig-system:system/aaa/authentication/config/authentication-method'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authentication/config/console-authentication-local'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authentication/config/failthrough'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      method: 'delete'
      data:

deleted_02:
  module_args:
    config: {}
    state: deleted
  existing_aaa_config:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      response:
        code: 200
        value:
          openconfig-system:config:
            authentication-method:
              - local
              - ldap
              - radius
              - tacacs+
            console-authentication-local: True
            failthrough: 'True'
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-tacacsplus-ext:commands/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-tacacsplus-ext:authorization-method:
            - local
            - tacacs+
    - path: '/data/openconfig-system:system/aaa/authorization/openconfig-aaa-ext:login/config/authorization-method'
      response:
        code: 200
        value:
          openconfig-aaa-ext:authorization-method:
            - local
            - ldap
  expected_config_requests:
    - path: '/data/openconfig-system:system/aaa/authentication/config'
      method: 'delete'
      data:
    - path: '/data/openconfig-system:system/aaa/authorization'
      method: 'delete'
      data:
