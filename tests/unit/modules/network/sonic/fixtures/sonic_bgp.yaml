---
merged_01:
  module_args:
    config:
      - bgp_as: 4
        router_id: 10.2.2.4
        rt_delay: 10
        log_neighbor_changes: false
        as_notation: "asdot+"
        timers:
          holdtime: 20
          keepalive_interval: 30
        bestpath:
          as_path:
            confed: true
            ignore: true
            multipath_relax: false
            multipath_relax_as_set: true
          bandwidth: default_weight
          compare_routerid: true
          med:
            confed: true
            missing_as_worst: true
            always_compare_med: true
        max_med:
          on_startup:
            timer: 667
            med_val: 7878
        graceful_restart:
          enabled: true
          restart_time: 100
          stale_routes_time: 1000
          preserve_fw_state: true
      - bgp_as: 10.5
        router_id: 10.2.2.5
        as_notation: "asdot"
        vrf_name: "VrfReg1"
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 4
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 655365
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          router-id: "10.2.2.4"
          as: 4.0
          route-map-process-delay: 10
          as-notation: "ASDOT_PLUS"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/hold-time"
      method: "patch"
      data:
        hold-time: 20
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/keepalive-interval"
      method: "patch"
      data:
        keepalive-interval: 30
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med"
      method: "patch"
      data:
        max-med:
          config:
            max-med-val: 7878
            time: 667
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options"
      method: "patch"
      data:
        route-selection-options:
          config:
            external-compare-router-id: true
            compare-confed-as-path: true
            ignore-as-path-length: true
            med-confed: true
            med-missing-as-worst: true
            always-compare-med: true
            compare-linkbw: "DEFAULT_WT"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/use-multiple-paths/ebgp/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          as-set: true
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          router-id: "10.2.2.5"
          as: "10.5"
          as-notation: "ASDOT"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          enabled: true
          restart-time: 100
          stale-routes-time: 1000
          preserve-fw-state: true

deleted_01:
  module_args:
    config:
      - bgp_as: 4
        router_id: 10.2.2.4
        rt_delay: 10
        log_neighbor_changes: false
        as_notation: "asdot+"
        bestpath:
          as_path:
            confed: true
            ignore: true
            multipath_relax: false
            multipath_relax_as_set: true
          bandwidth: default_weight
          compare_routerid: true
          med:
            confed: true
            missing_as_worst: true
            always_compare_med: true
        timers:
          holdtime: 20
          keepalive_interval: 30
        max_med:
          on_startup:
            timer: 667
            med_val: 7878
        graceful_restart:
          stale_routes_time: 1000
          preserve_fw_state: true
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 4
              router-id: "10.2.2.4"
              route-map-process-delay: 10
              hold-time: 20
              keepalive-interval: 30
              as-notation: "ASDOT_PLUS"
            logging-options:
              config:
                log-neighbor-state-changes: false
            route-selection-options:
              config:
                always-compare-med: true
                external-compare-router-id: true
                ignore-as-path-length: true
                compare-confed-as-path: true
                med-confed: true
                med-missing-as-worst: true
                compare-linkbw: "DEFAULT_WT"
            use-multiple-paths:
              ebgp:
                config:
                  allow-multiple-as: false
                  as-set: false
            max-med:
              config:
                time: 667
                max-med-val: 7878
            graceful-restart:
              config:
                enabled: true
                restart-time: 100
                stale-routes-time: 1000
                preserve-fw-state: true
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/hold-time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/keepalive-interval"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/router-id"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/as-notation"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/route-map-process-delay"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/max-med-val"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options"
      method: "patch"
      data:
        route-selection-options:
          config:
            external-compare-router-id: false
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             always-compare-med"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             compare-confed-as-path"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             compare-linkbw"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             ignore-as-path-length"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             med-confed"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             med-missing-as-worst"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config/\
             stale-routes-time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config/\
             preserve-fw-state"
      method: "delete"

deleted_02:
  module_args:
    config:
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 4
              router-id: "10.2.2.4"
              route-map-process-delay: 10
              hold-time: 20
              keepalive-interval: 30
              as-notation: "ASDOT"
            logging-options:
              config:
                log-neighbor-state-changes: false
            route-selection-options:
              config:
                always-compare-med: true
                external-compare-router-id: true
                ignore-as-path-length: true
                compare-confed-as-path: true
                med-confed: true
                med-missing-as-worst: true
                compare-linkbw: "DEFAULT_WT"
            use-multiple-paths:
              ebgp:
                config:
                  allow-multiple-as: false
                  as-set: false
            graceful-restart:
              config:
                enabled: true
                restart-time: 100
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp"
      method: "delete"

replaced_01:
  module_args:
    config:
      - bgp_as: 5
        vrf_name: 'VrfReg1'
        router_id: 10.2.2.5
        timers:
          holdtime: 20
          keepalive_interval: 30
      - bgp_as: 4
        router_id: 10.2.2.4
        as_notation: 'asdot+'
        max_med:
          on_startup:
            timer: 776
            med_val: 8787
        bestpath:
          bandwidth: ignore_weight
        graceful_restart:
          enabled: true
          preserve_fw_state: true
    state: replaced
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 4
              router-id: "10.2.2.4"
              route-map-process-delay: 10
              hold-time: 20
              keepalive-interval: 30
              as-notation: "ASDOT"
            logging-options:
              config:
                log-neighbor-state-changes: false
            route-selection-options:
              config:
                always-compare-med: true
                external-compare-router-id: true
                ignore-as-path-length: true
                compare-confed-as-path: true
                med-confed: true
                med-missing-as-worst: true
                compare-linkbw: "DEFAULT_WT"
            use-multiple-paths:
              ebgp:
                config:
                  allow-multiple-as: false
                  as-set: false
            max-med:
              config:
                time: 667
                max-med-val: 7878
            graceful-restart:
              config:
                enabled: true
                restart-time: 100
                stale-routes-time: 1000
                preserve-fw-state: false
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/hold-time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/keepalive-interval"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config/route-map-process-delay"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/max-med-val"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/logging-options/config/\
             log-neighbor-state-changes"
      method: "patch"
      data:
        log-neighbor-state-changes: true
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options"
      method: "patch"
      data:
        route-selection-options:
          config:
            external-compare-router-id: false
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options"
      method: "patch"
      data:
        route-selection-options:
          config:
            compare-linkbw: "IGNORE_LB"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             always-compare-med"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             compare-confed-as-path"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             ignore-as-path-length"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             med-confed"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             med-missing-as-worst"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config/\
             restart-time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config/\
             stale-routes-time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          as: 4.0
          as-notation: "ASDOT_PLUS"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med"
      method: "patch"
      data:
        max-med:
          config:
            max-med-val: 8787
            time: 776
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol/"
      method: "patch"
      data:
        openconfig-network-instance:protocol:
          - name: "bgp"
            identifier: "openconfig-policy-types:BGP"
            bgp:
              global:
                config:
                  as: 5.0
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          router-id: "10.2.2.5"
          as: 5.0
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config/hold-time"
      method: "patch"
      data:
        hold-time: 20
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config/keepalive-interval"
      method: "patch"
      data:
        keepalive-interval: 30
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          preserve-fw-state: true

overridden_01:
  module_args:
    config:
      - bgp_as: 5
        vrf_name: 'VrfReg2'
        router_id: 10.2.2.6
        rt_delay: 10
        log_neighbor_changes: true
      - bgp_as: 4
        router_id: 10.2.2.5
        rt_delay: 10
        as_notation: "asdot"
        bestpath:
          as_path:
            confed: true
            ignore: true
          bandwidth: ignore_weight
          compare_routerid: true
          med:
            confed: true
            missing_as_worst: true
        max_med:
          on_startup:
            timer: 776
            med_val: 8787
        graceful_restart:
          preserve_fw_state: true
    state: overridden
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 4
              router-id: "10.2.2.4"
              route-map-process-delay: 10
              hold-time: 180
              keepalive-interval: 60
              as-notation: "ASDOT_PLUS"
            logging-options:
              config:
                log-neighbor-state-changes: true
            route-selection-options:
              config:
                always-compare-med: true
                external-compare-router-id: true
                ignore-as-path-length: true
                compare-confed-as-path: true
                med-confed: true
                med-missing-as-worst: true
            use-multiple-paths:
              ebgp:
                config:
                  allow-multiple-as: false
                  as-set: false
            max-med:
              config:
                time: 667
                max-med-val: 7878
            graceful-restart:
              config:
                enabled: true
                preserve-fw-state: true
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 5
              router-id: "10.2.2.6"
              hold-time: 180
              keepalive-interval: 60
            logging-options:
              config:
                log-neighbor-state-changes: true
            route-selection-options:
              config:
                always-compare-med: false
                external-compare-router-id: false
                ignore-as-path-length: false
            use-multiple-paths:
              ebgp:
                config:
                  allow-multiple-as: false
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg2/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
            - vrf_name: VrfReg2
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/max-med-val"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med/config/time"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options/config/\
             always-compare-med"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/graceful-restart/config/\
             enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          router-id: "10.2.2.5"
          as: 4.0
          as-notation: "ASDOT"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/max-med"
      method: "patch"
      data:
        max-med:
          config:
            max-med-val: 8787
            time: 776
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg2/protocols/protocol/"
      method: "patch"
      data:
        openconfig-network-instance:protocol:
          - name: "bgp"
            identifier: "openconfig-policy-types:BGP"
            bgp:
              global:
                config:
                  as: 5.0
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg2/protocols/protocol=BGP,bgp/bgp/global/config"
      method: "patch"
      data:
        openconfig-network-instance:config:
          router-id: "10.2.2.6"
          route-map-process-delay: 10
          as: 5.0
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg2/protocols/protocol=BGP,bgp/bgp/global/logging-options/config/\
             log-neighbor-state-changes"
      method: "patch"
      data:
        log-neighbor-state-changes: true
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/route-selection-options"
      method: "patch"
      data:
        route-selection-options:
          config:
            compare-linkbw: "IGNORE_LB"
