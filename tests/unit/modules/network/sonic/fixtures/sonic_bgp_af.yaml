---
merged_01:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
            - afi: l2vpn
              safi: evpn
              advertise_pip: True
              advertise_pip_ip: "3.3.3.3"
              advertise_pip_peer_ip: "4.4.4.4"
              advertise_svi_ip: True
              advertise_all_vni: False
              advertise_default_gw: False
              route_advertise_list:
                - advertise_afi: ipv4
                  route_map: bb
                - advertise_afi: ipv6
                  route_map: bb
              dampening: True
            - afi: ipv4
              safi: unicast
              network:
                - 2.2.2.2/16
                - 192.168.10.1/32
              dampening: True
            - afi: ipv6
              safi: unicast
              dampening: True
              max_path:
                ebgp: 4
                ibgp: 5
              redistribute:
                - metric: "21"
                  protocol: connected
                  route_map: bb
                - metric: "27"
                  protocol: ospf
                  route_map: aa
                - metric: "26"
                  protocol: static
                  route_map: bb
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:L2VPN_EVPN'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:L2VPN_EVPN'
                l2vpn-evpn: 
                  openconfig-bgp-evpn-ext:config:
                    advertise-pip: True
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: True
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV4_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV6_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/network-config"
      method: "patch"
      data:
        network-config:
          network:
            - config:
                prefix: '2.2.2.2/16'
              prefix: '2.2.2.2/16'
            - config:
                prefix: '192.168.10.1/32'
              prefix: '192.168.10.1/32'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/route-flap-damping"
      method: "patch"
      data:
        route-flap-damping:
          config:
            enabled: True
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths"
      method: "patch"
      data:
        openconfig-network-instance:use-multiple-paths:
          ebgp:
            config:
              maximum-paths: 4
          ibgp:
            config:
              maximum-paths: 5
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV6
                metric: 21.0
                import-policy:
                  - bb
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV6
                metric: 27.0
                import-policy:
                  - aa
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV6
                metric: 26.0
                import-policy:
                  - bb
merged_02:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
            dampening: false
            max_path:
              ebgp: 2
              ibgp: 1
            advertise_all_vni: false
            redistribute:
              - metric: "20"
                protocol: connected
                route_map: aa
              - metric: "26"
                protocol: ospf
                route_map: bb
              - metric: "25"
                protocol: static
                route_map: aa
          - afi: ipv6
            safi: unicast
            max_path:
              ebgp: 1
              ibgp: 1
            advertise_all_vni: true
            redistribute:
              - metric: "21"
                protocol: connected
                route_map: bb
              - metric: "27"
                protocol: ospf
                route_map: aa
              - metric: "28"
                protocol: static
                route_map: aa
          - afi: l2vpn
            safi: evpn
            advertise_pip: True
            advertise_pip_ip: "3.3.3.3"
            advertise_pip_peer_ip: "4.4.4.4"
            advertise_svi_ip: True
            advertise_all_vni: True
            advertise_default_gw: False
            dampening: True
            max_path:
              ebgp: 4
              ibgp: 5
            route_advertise_list:
              - advertise_afi: ipv4
                route_map: aa
              - advertise_afi: ipv6
                route_map: bb
    state: merged
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
            afi-safis:
              afi-safi:
              - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                route-flap-damping:
                  config:
                    enabled: false
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 1
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                config:
                  afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                l2vpn-evpn:
                  openconfig-bgp-evpn-ext:config:
                    advertise-all-vni: true
                    advertise-default-gw: true
                    advertise-pip: true
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: true
                  openconfig-bgp-evpn-ext:route-advertise:
                    route-advertise-list:
                    - advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                        route-map:
                        - aa
                    - advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                        route-map:
                        - bb
                  openconfig-bgp-evpn-ext:vnis:
                    vni:
                    - config:
                        vni-number: 600
                      vni-number: 600
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV4
                metric: 20.0
                import-policy:
                  - aa
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV4
                metric: 26.0
                import-policy:
                  - bb
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV4
                metric: 25.0
                import-policy:
                  - aa
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV6
                metric: 21.0
                import-policy:
                  - bb
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV6
                metric: 27.0
                import-policy:
                  - aa
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV6
                metric: 28.0
                import-policy:
                  - aa
idemp_01:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
            dampening: false
            max_path:
              ebgp: 2
              ibgp: 1
            advertise_all_vni: false
          - afi: ipv6
            safi: unicast
            max_path:
              ebgp: 1
              ibgp: 1
            advertise_all_vni: true
          - afi: l2vpn
            safi: evpn
            advertise_pip: True
            advertise_pip_ip: "3.3.3.3"
            advertise_pip_peer_ip: "4.4.4.4"
            advertise_svi_ip: True
            advertise_all_vni: True
            advertise_default_gw: False
            dampening: True
            max_path:
              ebgp: 4
              ibgp: 5
            route_advertise_list:
              - advertise_afi: ipv4
                route_map: aa
              - advertise_afi: ipv6
                route_map: bb
    state: merged
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
            afi-safis:
              afi-safi:
              - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                route-flap-damping:
                  config:
                    enabled: false
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 1
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                config:
                  afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                l2vpn-evpn:
                  openconfig-bgp-evpn-ext:config:
                    advertise-all-vni: true
                    advertise-default-gw: true
                    advertise-pip: true
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: true
                  openconfig-bgp-evpn-ext:route-advertise:
                    route-advertise-list:
                    - advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                        route-map:
                        - aa
                    - advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                        route-map:
                        - bb
                  openconfig-bgp-evpn-ext:vnis:
                    vni:
                    - config:
                        vni-number: 600
                      vni-number: 600
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "DOES NOT MATTER. Just a stub init"
      method: "delete"

deleted_01:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
            dampening: true
            max_path:
              ebgp: 2
              ibgp: 1
            advertise_all_vni: false
            redistribute:
              - metric: "20"
                protocol: connected
                route_map: aa
              - metric: "26"
                protocol: ospf
                route_map: bb
              - metric: "25"
                protocol: static
                route_map: aa
          - afi: ipv6
            safi: unicast
            max_path:
              ebgp: 2
              ibgp: 1
            advertise_all_vni: true
            redistribute:
              - metric: "21"
                protocol: connected
                route_map: bb
              - metric: "27"
                protocol: ospf
                route_map: aa
              - metric: "28"
                protocol: static
                route_map: aa
          - afi: l2vpn
            safi: evpn
            advertise_pip: True
            advertise_pip_ip: "3.3.3.3"
            advertise_pip_peer_ip: "4.4.4.4"
            advertise_svi_ip: True
            advertise_all_vni: True
            advertise_default_gw: False
            dampening: True
            max_path:
              ebgp: 4
              ibgp: 5
            route_advertise_list:
              - advertise_afi: ipv4
                route_map: aa
              - advertise_afi: ipv6
                route_map: bb
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
            afi-safis:
              afi-safi:
              - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                route-flap-damping:
                  config:
                    enabled: true
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 1
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                config:
                  afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                l2vpn-evpn:
                  openconfig-bgp-evpn-ext:config:
                    advertise-all-vni: true
                    advertise-default-gw: true
                    advertise-pip: true
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: true
                  openconfig-bgp-evpn-ext:route-advertise:
                    route-advertise-list:
                    - advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                        route-map:
                        - aa
                    - advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                        route-map:
                        - bb
                  openconfig-bgp-evpn-ext:vnis:
                    vni:
                    - config:
                        vni-number: 600
                      vni-number: 600
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/route-flap-damping/config/enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-all-vni"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-peer-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-svi-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:route-advertise/route-advertise-list=IPV4_UNICAST/config/route-map=aa"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:route-advertise/route-advertise-list=IPV6_UNICAST/config/route-map=bb"
      method: "delete"

deleted_02:
  module_args:
    config: 
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
            afi-safis:
              afi-safi:
              - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                network-config:
                  network:
                    - config:
                        prefix: 22.22.22.22/16
                      prefix: 22.22.22.22/16
                route-flap-damping:
                  config:
                    enabled: true
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 1
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                config:
                  afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                route-flap-damping:
                  config:
                    enabled: true
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
                network-config:
                  network:
                    - config:
                        prefix: 22.22.22.22/16
                      prefix: 22.22.22.22/16
                l2vpn-evpn:
                  openconfig-bgp-evpn-ext:config:
                    advertise-all-vni: true
                    advertise-default-gw: true
                    advertise-pip: true
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: true
                  openconfig-bgp-evpn-ext:route-advertise:
                    route-advertise-list:
                    - advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                        route-map:
                          - aa
                    - advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                        route-map:
                          - bb
                  openconfig-bgp-evpn-ext:vnis:
                    vni:
                    - config:
                        vni-number: 600
                      vni-number: 600
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      response:
        code: 200
        value:
          openconfig-network-instance:table-connections:
            table-connection:
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 21.0
                  import-policy:
                    - bb
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:OSPF
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 27.0
                  import-policy:
                    - aa
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:STATIC
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 26.0
                  import-policy:
                    - bb
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/network-config/network=22.22.22.22%2f16"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/route-flap-damping/config/enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-all-vni"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-default-gw"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-peer-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-svi-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/network-config/network=22.22.22.22%2f16"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/route-flap-damping/config/enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=openconfig-bgp-types:IPV4_UNICAST"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=openconfig-bgp-types:IPV6_UNICAST"
      method: "delete"

merged_03:
  module_args:
    state: replaced
    config:
      - bgp_as: 51
        address_family:
          afis:
            - afi: ipv4
              safi: unicast
              max_path:
                ebgp: 2
                ibgp: 3
              redistribute:
                - metric: "20"
                  protocol: connected
                  route_map: rmap_reg1
                - metric: "26"
                  protocol: ospf
                  route_map: rmap_reg2
                - metric: "25"
                  protocol: static
                  route_map: rmap_reg3
            - afi: ipv6
              safi: unicast
              max_path:
                ebgp: 3
                ibgp: 4
              redistribute:
                - metric: "21"
                  protocol: connected
                  route_map: rmap_reg3
                - metric: "27"
                  protocol: ospf
                  route_map: rmap_reg1
                - metric: "28"
                  protocol: static
                  route_map: rmap_reg2
            - afi: l2vpn
              safi: evpn
              advertise_pip: True
              advertise_pip_ip: "1.1.1.1"
              advertise_pip_peer_ip: "2.2.2.2"
              advertise_svi_ip: True
              advertise_all_vni: True
              route_advertise_list:
                - advertise_afi: ipv4
                  route_map: rmap_reg1
      - bgp_as: 52
        vrf_name: "VrfReg1"
        address_family:
          afis:
            - afi: ipv4
              safi: unicast
              max_path:
                ebgp: 1
                ibgp: 2
              redistribute:
                - metric: "20"
                  protocol: connected
                  route_map: rmap_reg1
                - metric: "26"
                  protocol: ospf
                  route_map: rmap_reg2
                - metric: "25"
                  protocol: static
                  route_map: rmap_reg3
            - afi: ipv6
              safi: unicast
              max_path:
                ebgp: 3
                ibgp: 2
              redistribute:
                - metric: "21"
                  protocol: connected
                  route_map: rmap_reg3
                - metric: "27"
                  protocol: ospf
                  route_map: rmap_reg1
                - metric: "28"
                  protocol: static
                  route_map: rmap_reg2
            - afi: l2vpn
              safi: evpn
              route_advertise_list:
                - advertise_afi: ipv4
                  route_map: rmap_reg1
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 52
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV4_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV6_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:L2VPN_EVPN'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths"
      method: "patch"
      data:
        openconfig-network-instance:use-multiple-paths:
          ebgp:
            config:
              maximum-paths: 1
          ibgp:
            config:
              maximum-paths: 2
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths"
      method: "patch"
      data:
        openconfig-network-instance:use-multiple-paths:
          ebgp:
            config:
              maximum-paths: 3
          ibgp:
            config:
              maximum-paths: 2
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV4
                metric: 20.0
                import-policy:
                  - rmap_reg1
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV4
                metric: 26.0
                import-policy:
                  - rmap_reg2
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV4
                metric: 25.0
                import-policy:
                  - rmap_reg3
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV6
                metric: 21.0
                import-policy:
                  - rmap_reg3
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV6
                metric: 27.0
                import-policy:
                  - rmap_reg1
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV6
                metric: 28.0
                import-policy:
                  - rmap_reg2
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV4_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:IPV6_UNICAST'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:L2VPN_EVPN'
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      method: "patch"
      data:
        openconfig-network-instance:global:
          afi-safis:
            afi-safi:
              - afi-safi-name: 'openconfig-bgp-types:L2VPN_EVPN'
                l2vpn-evpn: 
                  openconfig-bgp-evpn-ext:config:
                    advertise-pip: True
                    advertise-pip-ip: 1.1.1.1
                    advertise-pip-peer-ip: 2.2.2.2
                    advertise-svi-ip: True
                    advertise-all-vni: True
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths"
      method: "patch"
      data:
        openconfig-network-instance:use-multiple-paths:
          ebgp:
            config:
              maximum-paths: 2
          ibgp:
            config:
              maximum-paths: 3
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths"
      method: "patch"
      data:
        openconfig-network-instance:use-multiple-paths:
          ebgp:
            config:
              maximum-paths: 3
          ibgp:
            config:
              maximum-paths: 4
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV4
                metric: 20.0
                import-policy:
                  - rmap_reg1
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV4
                metric: 26.0
                import-policy:
                  - rmap_reg2
            - address-family: openconfig-types:IPV4
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV4
                metric: 25.0
                import-policy:
                  - rmap_reg3
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      method: "patch"
      data:
        openconfig-network-instance:table-connections:
          table-connection:
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
              config: 
                address-family: openconfig-types:IPV6
                metric: 21.0
                import-policy:
                  - rmap_reg3
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:OSPF
              config: 
                address-family: openconfig-types:IPV6
                metric: 27.0
                import-policy:
                  - rmap_reg1
            - address-family: openconfig-types:IPV6
              dst-protocol: openconfig-policy-types:BGP
              src-protocol: openconfig-policy-types:STATIC
              config: 
                address-family: openconfig-types:IPV6
                metric: 28.0
                import-policy:
                  - rmap_reg2
deleted_03:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
          - afi: ipv6
            safi: unicast
            max_path:
              ebgp: 2
              ibgp: 1
            advertise_all_vni: true
            redistribute:
              - metric: "17"
                protocol: connected
                route_map: bb
              - metric: "18"
                protocol: ospf
                route_map: aa
              - metric: "19"
                protocol: static
                route_map: aa
          - afi: l2vpn
            safi: evpn
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global"
      response:
        code: 200
        value:
          openconfig-network-instance:global:
            config:
              as: 51
            afi-safis:
              afi-safi:
              - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                route-flap-damping:
                  config:
                    enabled: true
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                config:
                  afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 1
                  ibgp:
                    config:
                      maximum-paths: 1
              - afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                config:
                  afi-safi-name: openconfig-bgp-types:L2VPN_EVPN
                route-flap-damping:
                  config:
                    enabled: true
                use-multiple-paths:
                  ebgp:
                    config:
                      maximum-paths: 2
                  ibgp:
                    config:
                      maximum-paths: 1
                l2vpn-evpn:
                  openconfig-bgp-evpn-ext:config:
                    advertise-all-vni: true
                    advertise-default-gw: true
                    advertise-pip: true
                    advertise-pip-ip: 3.3.3.3
                    advertise-pip-peer-ip: 4.4.4.4
                    advertise-svi-ip: true
                  openconfig-bgp-evpn-ext:route-advertise:
                    route-advertise-list:
                    - advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV4_UNICAST
                        route-map:
                        - aa
                    - advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                      config:
                        advertise-afi-safi: openconfig-bgp-types:IPV6_UNICAST
                        route-map:
                        - bb
                  openconfig-bgp-evpn-ext:vnis:
                    vni:
                    - config:
                        vni-number: 600
                      vni-number: 600
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections"
      response:
        code: 200
        value:
          openconfig-network-instance:table-connections:
            table-connection:
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:DIRECTLY_CONNECTED
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 21.0
                  import-policy:
                    - bb
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:OSPF
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 27.0
                  import-policy:
                    - aa
              - address-family: openconfig-types:IPV6
                dst-protocol: openconfig-policy-types:BGP
                src-protocol: openconfig-policy-types:STATIC
                config: 
                  address-family: openconfig-types:IPV6
                  metric: 26.0
                  import-policy:
                    - bb
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/route-flap-damping/config/enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV4_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=IPV6_UNICAST/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-all-vni"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-default-gw"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-pip-peer-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/l2vpn-evpn/openconfig-bgp-evpn-ext:config/advertise-svi-ip"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/route-flap-damping/config/enabled"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/use-multiple-paths/ebgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=L2VPN_EVPN/use-multiple-paths/ibgp"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/afi-safis/afi-safi=openconfig-bgp-types:IPV4_UNICAST"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections/table-connection=openconfig-policy-types:DIRECTLY_CONNECTED,openconfig-policy-types:BGP,openconfig-types:IPV6"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections/table-connection=openconfig-policy-types:OSPF,openconfig-policy-types:BGP,openconfig-types:IPV6"
      method: "delete"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/table-connections/table-connection=openconfig-policy-types:STATIC,openconfig-policy-types:BGP,openconfig-types:IPV6"
      method: "delete"

