---
merged_01:
  module_args:
    config:
      - bgp_as: 51
        neighbors:
          - neighbor: Eth1/2
            auth_pwd:
              pwd: 'pw123'
              encrypted: false
            dont_negotiate_capability: true
            ebgp_multihop:
              enabled: true
              multihop_ttl: 1
            enforce_first_as: true
            enforce_multihop: true
            local_address: 'Ethernet4'
            local_as:
              as: 2
              no_prepend: true
              replace_as: true
            nbr_description: "description 1"
            override_capability: true
            passive: true
            port: 3
            shutdown_msg: 'msg1'
            solo: true
          - neighbor: 1.1.1.1
            disable_connected_check: true
            ttl_security: 5
      - bgp_as: 51
        vrf_name: VrfReg1
        peer_group:
          - name: SPINE
            bfd:
              check_failure: true
              enabled: true
              profile: 'profile 1'
            capability:
              dynamic: true
              extended_nexthop: true
            auth_pwd:
              pwd: 'U2FsdGVkX1/4sRsZ624wbAJfDmagPLq2LsGDOcW/47M='
              encrypted: true
            dont_negotiate_capability: true
            ebgp_multihop:
              enabled: true
              multihop_ttl: 1
            enforce_first_as: true
            enforce_multihop: true
            local_address: 'Ethernet4'
            local_as:
              as: 2
              no_prepend: true
              replace_as: true
            pg_description: 'description 1'
            override_capability: true
            passive: true
            solo: true
            remote_as:
              peer_as: 4
          - name: SPINE1
            disable_connected_check: true
            shutdown_msg: "msg1"
            strict_capability_match: true
            timers:
              keepalive: 30
              holdtime: 15
              connect_retry: 25
            ttl_security: 5
            address_family:
              afis:
                - afi: ipv4
                  safi: unicast
                  activate: true
                  allowas_in:
                    origin: true
                - afi: ipv6
                  safi: unicast
                  activate: true
                  allowas_in:
                    value: 5
        neighbors:
          - neighbor: Eth1/3
            remote_as:
              peer_as: 10
            peer_group: SPINE
            advertisement_interval: 15
            timers:
              keepalive: 30
              holdtime: 15
              connect_retry: 25
            bfd:
              check_failure: true
              enabled: true
              profile: 'profile 1'
            capability:
              dynamic: true
              extended_nexthop: true
            auth_pwd:
                pwd: 'U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg='
                encrypted: true
            nbr_description: 'description 2'
            strict_capability_match: true
            v6only: true
          - neighbor: 192.168.1.4
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - auth-password:
                config:
                  password: U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg=
                  encrypted: True
              neighbor-address: Eth1/3
              enable-bfd:
                config:
                  enabled: True
                  check-control-plane-failure: True
                  bfd-profile: 'profile 1'
              timers:
                config:
                  hold-time: 15
                  keepalive-interval: 30
                  connect-retry: 25
                  minimum-advertisement-interval: 15
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: Eth1/3
                peer-group: SPINE
                description: 'description 2'
                strict-capability-match: True
                openconfig-bgp-ext:v6only: True
                capability-dynamic: True
                capability-extended-nexthop: True
                peer-as: 10
            - neighbor-address: 192.168.1.4
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: 192.168.1.4
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups"
      method: "patch"
      data:
        openconfig-network-instance:peer-groups: 
          peer-group:
            - peer-group-name: SPINE
              auth-password:
                config:
                  password: U2FsdGVkX1/4sRsZ624wbAJfDmagPLq2LsGDOcW/47M=
                  encrypted: True
              enable-bfd:
                config:
                  enabled: True
                  check-control-plane-failure: True
                  bfd-profile: 'profile 1'
              ebgp-multihop:
                config:
                  enabled: True
                  multihop-ttl: 1
              transport:
                config:
                  local-address: Ethernet4
                  passive-mode: True
              config:
                peer-group-name: SPINE
                description: 'description 1'
                dont-negotiate-capability: True
                enforce-first-as: True
                enforce-multihop: True
                override-capability: True
                solo-peer: True
                local-as: 2
                local-as-no-prepend: True
                local-as-replace-as: True
                capability-dynamic: True
                capability-extended-nexthop: True
                peer-as: 4
            - peer-group-name: SPINE1
              timers:
                config:
                  hold-time: 15
                  keepalive-interval: 30
                  connect-retry: 25
              transport:
                config:
                  passive-mode: False
              afi-safis:
                afi-safi:
                  - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                    config:
                      enabled: True
                    allow-own-as:
                      config:
                        origin: True
                        enabled: True
                  - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                    config:
                      enabled: True
                    allow-own-as:
                      config:
                        as-count: 5
                        enabled: True
              config:
                peer-group-name: SPINE1
                disable-ebgp-connected-route-check: True
                shutdown-message: msg1
                strict-capability-match: True
                ttl-security-hops: 5
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - auth-password:
                config:
                  password: pw123
                  encrypted: False
              neighbor-address: Eth1/2
              ebgp-multihop:
                config:
                  enabled: True
                  multihop-ttl: 1
              transport:
                config:
                  local-address: Ethernet4
                  passive-mode: True
              config:
                neighbor-address: Eth1/2
                description: 'description 1'
                dont-negotiate-capability: True
                enforce-first-as: True
                enforce-multihop: True
                override-capability: True
                peer-port: 3
                shutdown-message: msg1
                solo-peer: True
                local-as: 2
                local-as-no-prepend: True
                local-as-replace-as: True
            - neighbor-address: 1.1.1.1
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: 1.1.1.1
                disable-ebgp-connected-route-check: True
                ttl-security-hops: 5
merged_02:
  module_args:
    config:
      - bgp_as: 51
        router_id: 10.2.2.4
        log_neighbor_changes: False
        bestpath:
          as_path:
            confed: True
            ignore: True
            multipath_relax: False
            multipath_relax_as_set: True
          compare_routerid: True
          med:
            confed: True
            missing_as_worst: True
        max_med:
          on_startup:
            timer: 667
            med_val: 7878
      - bgp_as: 52
        log_neighbor_changes: True
        vrf_name: vrf1
        bestpath:
          as_path:
            confed: False
            ignore: True
            multipath_relax_as_set: True
          compare_routerid: True
          med:
            confed: True
            missing_as_worst: True
        max_med:
          on_startup:
            timer: 332
            med_val: 9987
    state: merged
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 52
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value: []
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
        value: []
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: vrf1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - auth-password:
                config:
                  password: U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg=

merged_03:
  module_args:
    config:
      - bgp_as: 51
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
            advertise_all_vni: false
            redistribute:
              - metric: "20"
                protocol: connected
                route_map: aa
              - metric: "26"
                protocol: ospf
                route_map: bb
              - metric: "25"
                protocol: static
                route_map: aa
          - afi: ipv6
            safi: unicast
            advertise_all_vni: true
            redistribute:
              - metric: "21"
                protocol: connected
                route_map: bb
              - metric: "27"
                protocol: ospf
                route_map: aa
              - metric: "28"
                protocol: static
                route_map: aa
          - afi: l2vpn
            safi: evpn
            advertise_pip: True
            advertise_pip_ip: "3.3.3.3"
            advertise_pip_peer_ip: "4.4.4.4"
            advertise_svi_ip: True
            advertise_all_vni: True
            advertise_default_gw: False
            route_advertise_list:
              - advertise_afi: ipv4
                route_map: bb
              - advertise_afi: ipv6
                route_map: bb
            dampening: True
            max_path:
              ebgp: 4
              ibgp: 5
      - bgp_as: 52
        vrf_name: vrf1
        address_family:
          afis:
          - afi: ipv4
            safi: unicast
            redistribute:
              - metric: "20"
                protocol: connected
                route_map: aa
              - metric: "26"
                protocol: ospf
                route_map: bb
              - metric: "25"
                protocol: static
                route_map: aa
          - afi: ipv6
            safi: unicast
            redistribute:
              - metric: "21"
                protocol: connected
                route_map: bb
              - metric: "27"
                protocol: ospf
                route_map: aa
              - metric: "28"
                protocol: static
                route_map: aa
          - afi: l2vpn
            safi: evpn
            advertise_default_gw: True
            route_advertise_list:
              - advertise_afi: ipv4
                route_map: aa
              - advertise_afi: ipv6
                route_map: bb
    state: merged
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 52
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value: []
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
        value: []
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: vrf1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - auth-password:
                config:
                  password: U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg=

merged_04:
  module_args:
    config:
        - bgp_as: 51
          neighbors:
            - neighbor: Eth1/1
              remote_as:
                peer_type: internal
              peer_group: SPINE
              advertisement_interval: 10
              timers:
                keepalive: 40
                holdtime: 50
              bfd:
                enabled: false
              capability:
                dynamic: true
                extended_nexthop: true
            - neighbor: 192.168.1.4
            - neighbor: Eth1/2
              remote_as:
                peer_as: 3
              peer_group: SPINE2
              advertisement_interval: 20
              timers:
                keepalive: 30
                holdtime: 20
              capability:
                dynamic: true
          peer_group:
            - name: SPINE
              remote_as:
                peer_type: internal
              bfd:
                check_failure: true
                enabled: true
                profile: 'profile 1'
              advertisement_interval: 15
              timers:
                keepalive: 50
                holdtime: 40
              capability:
                dynamic: true
                extended_nexthop: true
              address_family:
                afis:
                  - afi: ipv4
                    safi: unicast
                    ip_afi:
                      default_policy_name: aa
                      send_default_route: false
                    prefix_limit:
                      max_prefixes: 200
                      prevent_teardown: false
                      warning_threshold: 88
                      restart_timer: 5
                    prefix_list_in: p2
                    prefix_list_out: p1
            - name: SPINE2
        - bgp_as: 52
          vrf_name: vrf1
          peer_group:
            - name: SPINE3
              remote_as:
                peer_type: internal
              bfd:
                check_failure: false
                enabled: true
                profile: 'profile 3'
              advertisement_interval: 15
              timers:
                keepalive: 50
                holdtime: 40
              capability:
                dynamic: true
                extended_nexthop: true
          neighbors:
            - neighbor: Eth1/11
              peer_group: SPINE3
            - neighbor: Eth1/12
    state: merged
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 52
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value: []
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
        value: []
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: vrf1
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - neighbor-address: Eth1/1
              enable-bfd:
                config:
                  enabled: False
              timers:
                config:
                  hold-time: 50
                  keepalive-interval: 40
                  minimum-advertisement-interval: 10
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: Eth1/1
                peer-group: SPINE
                capability-dynamic: True
                capability-extended-nexthop: True
                peer-type: INTERNAL
            - neighbor-address: 192.168.1.4
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: 192.168.1.4
            - neighbor-address: Eth1/2
              timers:
                config:
                  hold-time: 20
                  keepalive-interval: 30
                  minimum-advertisement-interval: 20
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: Eth1/2
                peer-group: SPINE2
                capability-dynamic: True
                peer-as: 3
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      method: "patch"
      data:
        openconfig-network-instance:peer-groups:
          peer-group:
            - peer-group-name: SPINE
              enable-bfd:
                config:
                  enabled: True
                  check-control-plane-failure: True
                  bfd-profile: 'profile 1'
              timers:
                config:
                  hold-time: 40
                  keepalive-interval: 50
                  minimum-advertisement-interval: 15
              transport:
                config:
                  passive-mode: False
              afi-safis:
                afi-safi:
                  - afi-safi-name: 'openconfig-bgp-types:IPV4_UNICAST'
                    config:
                      afi-safi-name: 'openconfig-bgp-types:IPV4_UNICAST'
                    ipv4-unicast:
                      config:
                        default-policy-name: aa
                        send-default-route: False
                      prefix-limit: 
                        config:
                          max-prefixes: 200
                          prevent-teardown: False
                          warning-threshold-pct: 88
                          restart-timer: 5
                    prefix-list:
                      config:
                        import-policy: p2
                        export-policy: p1
              config:
                peer-group-name: SPINE
                capability-dynamic: True
                capability-extended-nexthop: True
                peer-type: INTERNAL
            - peer-group-name: SPINE2
              transport:
                config:
                  passive-mode: False
              config:
                peer-group-name: SPINE2
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/neighbors"
      method: "patch"
      data:
        openconfig-network-instance:neighbors:
          neighbor:
            - neighbor-address: Eth1/11
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: Eth1/11
                peer-group: SPINE3
            - neighbor-address: Eth1/12
              transport:
                config:
                  passive-mode: False
              config:
                neighbor-address: Eth1/12
    - path: "/data/openconfig-network-instance:network-instances/network-instance=vrf1/protocols/protocol=BGP,bgp/bgp/peer-groups"
      method: "patch"
      data:
        openconfig-network-instance:peer-groups:
          peer-group:
            - peer-group-name: SPINE3
              enable-bfd:
                config:
                  enabled: True
                  check-control-plane-failure: False
                  bfd-profile: 'profile 3'
              timers:
                config:
                  hold-time: 40
                  keepalive-interval: 50
                  minimum-advertisement-interval: 15
              transport:
                config:
                  passive-mode: False
              config:
                peer-group-name: SPINE3
                capability-dynamic: True
                capability-extended-nexthop: True
                peer-type: INTERNAL
deleted_01:
  module_args:
    config:
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
            router-id: "10.2.2.4"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
            router-id: "10.2.2.4"
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value:
          openconfig-network-instance:neighbors:
            neighbor:
              - auth-password:
                  config:
                    password: U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg=
                    encrypted: True
                neighbor-address: Eth1/3
                enable-bfd:
                  config:
                    enabled: True
                    check-control-plane-failure: True
                    bfd-profile: 'profile 1'
                timers:
                  config:
                    hold-time: 15
                    keepalive-interval: 30
                    connect-retry: 25
                    minimum-advertisement-interval: 15
                transport:
                  config:
                    passive-mode: False
                config:
                  neighbor-address: Eth1/3
                  peer-group: SPINE
                  description: 'description 2'
                  strict-capability-match: True
                  openconfig-bgp-ext:v6only: True
                  capability-dynamic: True
                  capability-extended-nexthop: True
                  peer-as: 10
              - neighbor-address: 192.168.1.4
                transport:
                  config:
                    passive-mode: False
                config:
                  neighbor-address: 192.168.1.4
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value:
          openconfig-network-instance:neighbors:
            neighbor:
              - auth-password:
                  config:
                    password: pw123
                    encrypted: False
                neighbor-address: Eth1/2
                ebgp-multihop:
                  config:
                    enabled: True
                    multihop-ttl: 1
                transport:
                  config:
                    local-address: Ethernet4
                    passive-mode: True
                config:
                  neighbor-address: Eth1/2
                  description: 'description 1'
                  dont-negotiate-capability: True
                  enforce-first-as: True
                  enforce-multihop: True
                  override-capability: True
                  peer-port: 3
                  shutdown-message: msg1
                  solo-peer: True
                  local-as: 2
                  local-as-no-prepend: True
                  local-as-replace-as: True
              - neighbor-address: 1.1.1.1
                transport:
                  config:
                    passive-mode: False
                config:
                  neighbor-address: 1.1.1.1
                  disable-ebgp-connected-route-check: True
                  ttl-security-hops: 5
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=192.168.1.4/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=Eth1%2f3/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=1.1.1.1/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=Eth1%2f2/"
      method: "delete"
      data:
deleted_02:
  module_args:
    config:
      - bgp_as: 51
        vrf_name: VrfReg1
        neighbors:
          - neighbor: 192.168.1.4
          - neighbor: Eth1/3
        peer_group:
          - name: SPINETEST1
            capability:
              dynamic: true
              extended_nexthop: true
            remote_as:
              peer_as: 65399
            timers:
              keepalive: 77
              connect_retry: 11
            bfd:
              enabled: true
              check_failure: true
              profile: 'kvsk_bfd_profile'
            ebgp_multihop:
              enabled: true
              multihop_ttl: 22
            auth_pwd:
              encrypted: true
              pwd: 'U2FsdGVkX1+LHXncDf0uAxQrs4CN7H5yDKT5sht6Ga4='
            enforce_first_as: true
            enforce_multihop: true
            pg_description: 'pg_kvsk_description'
            disable_connected_check: true
            dont_negotiate_capability: true
            local_as: 
              as: 65299
              no_prepend: true
              replace_as: true
            override_capability: true
            shutdown_msg: pg_kvsk_shutdown_msg
            passive: true
            local_address: 5.5.5.5
            solo: true                    
            address_family:
              afis:
                - afi: ipv4
                  safi: unicast
                  activate: true
                  allowas_in:
                    value: 8
                - afi: ipv6
                  safi: unicast
                  activate: true
                  allowas_in:
                    value: 9            
      - bgp_as: 51
        neighbors:
          - neighbor: 1.1.1.1
          - neighbor: Eth1/2
    state: deleted
  existing_bgp_config:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
            router-id: "10.2.2.4"
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/global/config"
      response:
        code: 200
        value:
          openconfig-network-instance:config:
            as: 51
            router-id: "10.2.2.4"
    - path: "data/sonic-vrf:sonic-vrf/VRF/VRF_LIST"
      response:
        code: 200
        value:
          sonic-vrf:VRF_LIST:
            - vrf_name: default
            - vrf_name: VrfReg1
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
        value:
          openconfig-network-instance:peer-groups:
            peer-group:
              - config:
                  capability-dynamic: true
                  capability-extended-nexthop: true
                  enabled: true
                  peer-group-name: SPINETEST1
                  description: "pg_kvsk_description"
                  disable-ebgp-connected-route-check: true
                  dont-negotiate-capability: true
                  enforce-first-as: true
                  enforce-multihop: true
                  local-as: 65299
                  shutdown-message: pg_kvsk_shutdown_msg
                  local-as-no-prepend: true
                  local-as-replace-as: true
                  override-capability: true
                  peer-as: 65399
                  solo-peer: true                    
                peer-group-name: SPINETEST1
                enable-bfd:
                  config:
                    enabled: true
                    check-control-plane-failure: true
                    bfd-profile: 'kvsk_bfd_profile'
                ebgp-multihop:
                  config:
                    enabled: true
                    multihop-ttl: 22
                auth-password: 
                  config:
                    encrypted: true
                    password: 'U2FsdGVkX1+LHXncDf0uAxQrs4CN7H5yDKT5sht6Ga4='
                timers:
                  config:
                    keepalive-interval: 77
                    connect-retry: 11
                transport:
                  config:
                    passive-mode: true                    
                    local-address: 5.5.5.5
                afi-safis:
                  afi-safi:
                    - afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                      allow-own-as:
                        config:
                          as-count: 8
                      config:
                        afi-safi-name: openconfig-bgp-types:IPV4_UNICAST
                    - afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
                      allow-own-as:
                        config:
                          as-count: 9
                      config:
                        afi-safi-name: openconfig-bgp-types:IPV6_UNICAST
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value:
          openconfig-network-instance:neighbors:
            neighbor:
              - auth-password:
                  config:
                    password: U2FsdGVkX199MZ7YOPkOR9O6wEZmtGSgiDfnlcN9hBg=
                    encrypted: True
                neighbor-address: Eth1/3
                enable-bfd:
                  config:
                    enabled: True
                    check-control-plane-failure: True
                    bfd-profile: 'profile 1'
                timers:
                  config:
                    hold-time: 15
                    keepalive-interval: 30
                    connect-retry: 25
                    minimum-advertisement-interval: 15
                transport:
                  config:
                    passive-mode: False
                config:
                  neighbor-address: Eth1/3
                  peer-group: SPINETEST1
                  description: 'description 2'
                  strict-capability-match: True
                  openconfig-bgp-ext:v6only: True
                  capability-dynamic: True
                  capability-extended-nexthop: True
                  peer-as: 10
              - neighbor-address: 192.168.1.4
                config:
                  neighbor-address: 192.168.1.4
                  capability-extended-nexthop: True
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors"
      response:
        code: 200
        value:
          openconfig-network-instance:neighbors:
            neighbor:
              - auth-password:
                  config:
                    password: pw123
                    encrypted: False
                neighbor-address: Eth1/2
                ebgp-multihop:
                  config:
                    enabled: True
                    multihop-ttl: 1
                transport:
                  config:
                    local-address: Ethernet4
                    passive-mode: False
                config:
                  neighbor-address: Eth1/2
                  description: 'description 1'
                  dont-negotiate-capability: True
                  enforce-first-as: True
                  enforce-multihop: True
                  override-capability: True
                  peer-port: 3
                  shutdown-message: msg1
                  solo-peer: True
                  local-as: 2
                  local-as-no-prepend: True
                  local-as-replace-as: True
                  capability-extended-nexthop: True
              - neighbor-address: 1.1.1.1
                transport:
                  config:
                    passive-mode: False
                config:
                  neighbor-address: 1.1.1.1
                  disable-ebgp-connected-route-check: True
                  ttl-security-hops: 5
                  capability-extended-nexthop: True
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/peer-groups"
      response:
        code: 200
  expected_config_requests:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=192.168.1.4/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=Eth1%2f3/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/afi-safis/afi-safi=openconfig-bgp-types:IPV4_UNICAST/allow-own-as/config/as-count"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/afi-safis/afi-safi=openconfig-bgp-types:IPV6_UNICAST/allow-own-as/config/as-count"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/config/capability-dynamic"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/config/capability-extended-nexthop"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/config/peer-as"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/enable-bfd/config/bfd-profile"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/enable-bfd/config/check-control-plane-failure"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/enable-bfd/config/enabled"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/timers/config/connect-retry"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=VrfReg1/protocols/protocol=BGP,bgp/bgp/peer-groups/peer-group=SPINETEST1/timers/config/keepalive-interval"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=1.1.1.1/"
      method: "delete"
      data:
    - path: "/data/openconfig-network-instance:network-instances/network-instance=default/protocols/protocol=BGP,bgp/bgp/neighbors/neighbor=Eth1%2f2/"
      method: "delete"
      data:
